<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Workshops</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <a href="/" class="home-button">‚Üê Back to Home</a>

    <div class="container">
      <header>
        <h1>Admin Panel</h1>
        <p style="opacity: 0.9">Logged in as: {{.Username}}</p>
      </header>

      <main>
        {{if .PasswordChanged}}
        <div class="success-message">‚úì Password changed successfully!</div>
        {{end}} {{if .PasswordError}}
        <div class="error-message">‚úó {{.PasswordError}}</div>
        {{end}}

        <!-- Change Password Section -->
        <section class="admin-section">
          <h2>Change Password</h2>
          <form
            action="/admin/change-password"
            method="POST"
            class="workshop-form"
          >
            <label for="current_password">Current Password *</label>
            <input
              type="password"
              id="current_password"
              name="current_password"
              required
            />

            <label for="new_password">New Password * (min 6 characters)</label>
            <input
              type="password"
              id="new_password"
              name="new_password"
              minlength="6"
              required
            />

            <label for="confirm_password">Confirm New Password *</label>
            <input
              type="password"
              id="confirm_password"
              name="confirm_password"
              minlength="6"
              required
            />

            <button type="submit">Change Password</button>
          </form>
        </section>

        <!-- Create New Workshop Section -->
        <section class="admin-section">
          <h2>Create New Workshop</h2>
          <form
            action="/admin/create-workshop"
            method="POST"
            class="workshop-form"
          >
            <label for="title">Workshop Title *</label>
            <input type="text" id="title" name="title" required />

            <label for="description">Description *</label>
            <textarea
              id="description"
              name="description"
              rows="4"
              required
            ></textarea>

            <label for="workshop_date">Date *</label>
            <input
              type="date"
              id="workshop_date"
              name="workshop_date"
              required
            />

            <label for="workshop_time">Time *</label>
            <input
              type="time"
              id="workshop_time"
              name="workshop_time"
              required
            />

            <label for="location">Location *</label>
            <input type="text" id="location" name="location" required />

            <label for="max_capacity">Max Capacity *</label>
            <input
              type="number"
              id="max_capacity"
              name="max_capacity"
              value="20"
              min="1"
              required
            />

            <button type="submit">Create Workshop</button>
          </form>
        </section>

        <!-- Current Workshop & Signups Section -->
        {{if .Workshop}}
        <section class="admin-section">
          <h2>Current Workshop</h2>
          <div class="current-workshop">
            <h3>{{.Workshop.Title}}</h3>
            <p><strong>Date:</strong> {{.Workshop.Date}}</p>
            <p>
              <strong>Spots Filled:</strong> {{.Count}} /
              {{.Workshop.MaxCapacity}}
            </p>
          </div>

          <!-- Export Button -->
          {{if .Signups}}
          <div style="margin: 20px 0">
            <a href="/admin/export-csv" class="export-button"
              >üì• Export Signups to CSV</a
            >
          </div>
          {{end}}

          <h3>Signups</h3>
          {{if .Signups}}
          <table>
            <thead>
              <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Signed Up</th>
              </tr>
            </thead>
            <tbody>
              {{range .Signups}}
              <tr>
                <td>{{.FirstName}}</td>
                <td>{{.LastName}}</td>
                <td>{{.Email}}</td>
                <td>{{.Phone}}</td>
                <td>{{.CreatedAt}}</td>
              </tr>
              {{end}}
            </tbody>
          </table>
          {{else}}
          <p style="text-align: center; padding: 40px; color: #666">
            No signups yet.
          </p>
          {{end}}
        </section>
        {{else}}
        <section class="admin-section">
          <p style="text-align: center; padding: 20px; color: #666">
            No workshops created yet. Use the form above to create your first
            workshop!
          </p>
        </section>
        {{end}}
      </main>
    </div>
  </body>
</html>
